/*
  WebSettings.h - Glow Worm Luciferin for Firefly Luciferin
  All in one Bias Lighting system for PC

  Copyright Â© 2020 - 2026  Davide Perini

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <https://www.gnu.org/licenses/>.
*/

#ifndef GLOW_WORM_LUCIFERIN_WEBSETTINGS_H
#define GLOW_WORM_LUCIFERIN_WEBSETTINGS_H

const char settingsPage[] PROGMEM = R"=====(<!DOCTYPE html><html><head><title>LUCIFERIN Web Interface</title><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'><link rel="icon" type="image/png" href="https://sblantipodi.github.io/glow_worm_luciferin/static/logos/luciferin_logo.png"><script src='https://sblantipodi.github.io/glow_worm_luciferin/third_party_scripts/jquery-3.6.0.slim.min.js' integrity='sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=' crossorigin='anonymous'></script><link href='https://sblantipodi.github.io/glow_worm_luciferin/third_party_scripts/bootstrap.min.css' rel='stylesheet'><script src='https://sblantipodi.github.io/glow_worm_luciferin/third_party_scripts/bootstrap.bundle.min.js'></script><script src='https://sblantipodi.github.io/glow_worm_luciferin/third_party_scripts/iro5_2_2.js'></script><link href='https://sblantipodi.github.io/glow_worm_luciferin/fa6/css/all.css' rel='stylesheet'><link href='https://sblantipodi.github.io/glow_worm_luciferin/webInterface_1.1.4.slim.min.css' rel='stylesheet'></head><body><div class='container-fluid p-2 bg-primary text-white text-center sticky-top'><h1>LUCIFERIN</h1><p id="subtitle"></p></div><div class='container'><div class='row'><div class='col' class='margin-2'><form><button onclick="window.location.href='setsettings'" type="button" class="btn right-btn btn-outline-warning waves-effect px-3 sticky-top position-fixed"><i class="fas fa-bars" aria-hidden="true"></i></button><div class='form-group row'><div class='col-sm-12'><div class='wrap'><div id='picker'></div></div><div class='wrap slider-margin'><div class="ColorPicker" id='brightnessSlider'></div></div><div class='wrap slider-margin'><div class="ColorPicker" id="kelvinPicker"></div></div><div id="ut" class='wrap'></div></div><div class='col-sm-12'><button id='toggleLED' type='button' class='btn btn-primary' data-bs-toggle='button' autocomplete='off'>Turn ON </button></div><div class='col-sm-12'><div class='form-floating'><select class='form-select' id='effectSelect'></select><label for='effectSelect'>EFFECT</label></div></div></div></form></div></div></div><footer><div class='text-center'><small><span id="et"><i class="fa-solid fa-ethernet"></i></span><span id="wf"><i class="fa-solid fa-wifi"></i><span id='wifi'>_</span></span>/ <i class="fa-solid fa-gauge-high"></i><span id='fps'>_</span><span id="ldrgrp"> / <i class="fa-solid fa-sun"></i><span id='ldr'>_</span></span><br><a id='gitlink' class='text-dark' href='https://github.com/sblantipodi/'>_</a></small><div class="mgntop-small"><button id="autosave" type="button" class="btn btn-primary btn-sm saveBtn">Save state</button></div></div></footer><script src='https://sblantipodi.github.io/glow_worm_luciferin/webInterface_1.6.2.slim.min.js'></script><script>const cbAs = document.getElementById('autosave');cbAs.onclick = () => { asCBAction(cbAs);};</script></body></html>)=====";

const char setSettingsPage[] PROGMEM = R"=====(<!DOCTYPE html><html lang="en"><head><title>LUCIFERIN Web Interface</title><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'><link rel="icon" type="image/png" href="https://sblantipodi.github.io/glow_worm_luciferin/static/logos/luciferin_logo.png"><script src='https://sblantipodi.github.io/glow_worm_luciferin/third_party_scripts/jquery-3.6.0.slim.min.js' integrity='sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=' crossorigin='anonymous'></script><link href='https://sblantipodi.github.io/glow_worm_luciferin/third_party_scripts/bootstrap.min.css' rel='stylesheet'><script src='https://sblantipodi.github.io/glow_worm_luciferin/third_party_scripts/bootstrap.bundle.min.js'></script><script src='https://sblantipodi.github.io/glow_worm_luciferin/third_party_scripts/iro5_2_2.js'></script><link href='https://sblantipodi.github.io/glow_worm_luciferin/fa6/css/all.css' rel='stylesheet'><link href='https://sblantipodi.github.io/glow_worm_luciferin/webInterface_1.1.4.slim.min.css' rel='stylesheet'></head><body><div class='container-fluid p-2 bg-primary text-white text-center sticky-top'><h1>LUCIFERIN</h1><p id="subtitle"></p></div><div class='container'></div><script src='https://sblantipodi.github.io/glow_worm_luciferin/webInterfaceSettings_1.6.4.slim.min.js'></script><script></script></body></html></title></head><body></body></html>)=====";

const char setSettingsPageOffline[] PROGMEM = R"=====(<!DOCTYPE html><html><head><title>LUCIFERIN Web Interface</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"></head><style>input[type=password], input[type=text], select { width: 100%; padding: 12px 20px; margin: 8px 0; display: inline-block; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box}input[type=submit] { width: 100%; background-color: orange; color: #fff; padding: 14px 20px; margin: 8px 0; border: none; border-radius: 4px; cursor: pointer; font-weight: 700}.orangebox, input[type=submit]:hover { background-color: orange; color: #fff; text-align: center}div { border-radius: 5px; background-color: #f2f2f2; padding: 20px}</style><body><div><div class="orangebox"><h1>LUCIFERIN</h1><h3>Bias Lighting and Ambient Light firmware designed for Firefly Luciferin</h3></div><br><br><form onsubmit='callDevice(); return false;'><label for="deviceName">Device Name *</label><input type="text" id="deviceName" name="deviceName" required><br><br><input type="checkbox" class="form-check-input" id="dhcpCheckbox" checked="checked"><label class="form-check-label" for="dhcpCheckbox">Enable DHCP</label><br><br><label for="microcontrollerIP">IP address</label><input type="text" class="form-control" id="microcontrollerIP"><span id="enEth"><br><br><input type="checkbox" class="form-check-input" id="ethCbx"><label class="form-check-label" for="ethCbx">Enable Ethernet</label></span><span class='form-floating' id="eth"><select class='form-select' id='ethd'></select></span><br><span id='wifi'><br><label for="ssid">Network name</label><input type="text" class="form-control" id="ssid"><label for="wifipwd">WiFi password</label><input type="password" class="form-control" id="wifipwd"><br><br></span><input type="checkbox" class="form-check-input" id="mqttCheckbox" checked="checked"><label class="form-check-label" for="mqttCheckbox">Enable MQTT</label><br><br><label for="inputMqttIp">MQTT server IP *</label><input type="text" class="form-control" id="inputMqttIp"><label for="mqttPort">MQTT server port *</label><input type="text" class="form-control" id="mqttPort"><label for="mqttTopic">MQTT topic *</label><input type="text" class="form-control" id="mqttTopic"><label for="mqttuser">MQTT server username</label><input type="text" class="form-control" id="mqttuser"><label for="mqttpass">MQTT server password</label><input type="password" class="form-control" id="mqttpass"><br><br><label for="br">BAUD RATE</label><select class="form-select" id="br"></select><label for="lednum">LEDs number*</label><input type="text" class="form-control" id="lednum" required><label for="colorMode">COLOR MODE</label><select class="form-select" id="colorMode"></select><label for="colorOrder">COLOR ORDER</label><select class="form-select" id="colorOrder"></select><label for="additionalParam">GPIO PIN for the LED strip*</label><input type="text" class="form-control" id="additionalParam" required><span id="clock"><label for="gpioClock">GPIO CLOCK PIN for the LED strip</label><input type="text" class="form-control" id="gpioClock"></span><br><br><input type="submit" value="SAVE SETTINGS"></form></div><script>var received = false;function poll() { var sleep = time => new Promise(resolve => setTimeout(resolve, time)); var poll = (promiseFn, time) => promiseFn().then(sleep(time).then(() => poll(promiseFn, time))); poll(() => new Promise(() => { if (!received) { received = true; const http = new XMLHttpRequest(); http.open('GET', 'getsettings'); http.send(); http.onload = () => { console.log(http.responseText); var prefs = JSON.parse(http.responseText); console.log(prefs); document.getElementById('deviceName').value = prefs.deviceName; document.getElementById('microcontrollerIP').value = prefs.ip; if (prefs.dhcp == '1') { document.getElementById('microcontrollerIP').disabled = true; } else { document.getElementById("dhcpCheckbox").click(); } if (prefs.mqttIp.length == 0 || prefs.mqttIp === 'XXX') { document.getElementById("mqttCheckbox").click(); } if (prefs.ethd >= 1) { document.getElementById("ethCbx").click(); } if (prefs.ethd == -1) { document.getElementById("enEth").style.display = "none"; } if (prefs.ethd == -1 || prefs.ethd == 0) { document.getElementById("eth").style.display = "none"; } document.getElementById("ethd").value = prefs.ethd; document.getElementById('inputMqttIp').value = prefs.mqttIp; document.getElementById('ssid').value = prefs.ssid; document.getElementById('wifipwd').value = "***************"; document.getElementById('mqttPort').value = prefs.mqttPort; document.getElementById('mqttTopic').value = prefs.mqttTopic; document.getElementById('mqttuser').value = prefs.mqttuser; document.getElementById('mqttpass').value = prefs.mqttpass; document.getElementById('lednum').value = prefs.lednum; document.getElementById('additionalParam').value = prefs.gpio; document.getElementById('gpioClock').value = prefs.gpioClock; document.getElementById('colorMode').value = prefs.colorMode; document.getElementById('colorOrder').value = prefs.colorOrder; document.getElementById('br').value = prefs.br; if (prefs.colorMode == '5') { document.getElementById("clock").style.display = "block"; } else { document.getElementById("clock").style.display = "none"; } } } }), 5000);}function callDevice() { var payload = { deviceName: encodeURIComponent(document.getElementById('deviceName').value), microcontrollerIP: (document.getElementById("dhcpCheckbox").checked ? '' : document.getElementById('microcontrollerIP').value), ethd: (document.getElementById("ethCbx").checked ? document.getElementById('ethd').value : 0), ssid: encodeURIComponent(document.getElementById('ssid').value), wifipwd: (document.getElementById('wifipwd').value != "***************") ? encodeURIComponent(document.getElementById('wifipwd').value) : "", mqttCheckbox: document.getElementById("mqttCheckbox").checked, mqttIP: document.getElementById('inputMqttIp').value, mqttPort: document.getElementById('mqttPort').value, mqttTopic: encodeURIComponent(document.getElementById('mqttTopic').value), mqttuser: encodeURIComponent(document.getElementById('mqttuser').value), mqttpass: encodeURIComponent(document.getElementById('mqttpass').value), additionalParam: document.getElementById('additionalParam').value, gpioClock: document.getElementById('gpioClock').value, colorMode: document.getElementById('colorMode').value, colorOrder: document.getElementById('colorOrder').value, br: document.getElementById('br').value, lednum: document.getElementById('lednum').value }; const http = new XMLHttpRequest(); http.open('GET', 'setting?payload=' + JSON.stringify(payload)); http.send(); http.onload = () => { console.log(http.responseText); alert("Success: rebooting the microcontroller"); return false; };}function cbxAcn(cbMqtt, cbDhcp) { if (cbMqtt.checked) { document.getElementById('inputMqttIp').setAttribute('required', ''); document.getElementById('mqttPort').setAttribute('required', ''); document.getElementById('mqttTopic').setAttribute('required', ''); document.getElementById('inputMqttIp').disabled = false; document.getElementById('mqttPort').disabled = false; document.getElementById('mqttTopic').disabled = false; document.getElementById('mqttuser').disabled = false; document.getElementById('mqttpass').disabled = false; document.getElementById('inputMqttIp').disabled = false; } else { document.getElementById('inputMqttIp').removeAttribute('required'); document.getElementById('inputMqttIp').disabled = true; document.getElementById('mqttPort').removeAttribute('required'); document.getElementById('mqttPort').disabled = true; document.getElementById('mqttPort').value = ""; document.getElementById('mqttPort').disabled = true; document.getElementById('mqttTopic').removeAttribute('required'); document.getElementById('mqttTopic').disabled = true; document.getElementById('mqttTopic').value = ""; document.getElementById('mqttTopic').disabled = true; document.getElementById('mqttuser').value = ""; document.getElementById('mqttuser').disabled = true; document.getElementById('mqttpass').value = ""; document.getElementById('mqttpass').disabled = true; document.getElementById('inputMqttIp').value = ""; document.getElementById('inputMqttIp').disabled = true; } if (cbDhcp.checked) { document.getElementById('microcontrollerIP').disabled = true; } else { document.getElementById('microcontrollerIP').disabled = false; } if (cbEth.checked) { if (document.getElementById('ethd').value === 0 || document.getElementById('ethd').value === null || document.getElementById('ethd').value === '') { document.getElementById('ethd').value = 1; } document.getElementById('inputMqttIp').removeAttribute('required'); document.getElementById('mqttPort').removeAttribute('required'); document.getElementById('mqttTopic').removeAttribute('required'); document.getElementById("eth").style.display = "block"; document.getElementById("wifi").style.display = "none"; } else { document.getElementById("eth").style.display = "none"; document.getElementById("wifi").style.display = "block"; }}const sleep = (s) => { return new Promise(resolve => setTimeout(resolve, (s)));};sleep(100).then(() => { document.getElementById('colorMode').append(new Option("RGB", "1")); document.getElementById('colorMode').append(new Option("RGBW", "2")); document.getElementById('colorMode').append(new Option("RGBW (Brighter)", "3")); document.getElementById('colorMode').append(new Option("RGBW (RGB only)", "4")); document.getElementById('colorMode').append(new Option("DotStar", "5")); document.getElementById('colorOrder').append(new Option("GRB", "1")); document.getElementById('colorOrder').append(new Option("RGB", "2")); document.getElementById('colorOrder').append(new Option("BGR", "3")); document.getElementById('colorOrder').append(new Option("BRG", "4")); document.getElementById('colorOrder').append(new Option("RBG", "5")); document.getElementById('colorOrder').append(new Option("GBR", "6")); document.getElementById('br').append(new Option("115200", "8")); document.getElementById('br').append(new Option("230400", "1")); document.getElementById('br').append(new Option("460800", "2")); document.getElementById('br').append(new Option("500000", "3")); document.getElementById('br').append(new Option("921600", "4")); document.getElementById('br').append(new Option("1000000", "5")); document.getElementById('br').append(new Option("1500000", "6")); document.getElementById('br').append(new Option("2000000", "7")); document.getElementById('br').append(new Option("4000000", "9")); document.getElementById('br').append(new Option("6000000", "10")); });document.getElementById('colorMode').addEventListener('change', function () { var data = this.value; if (data == 5) { document.getElementById("clock").style.display = "block"; } else { document.getElementById("clock").style.display = "none"; }});const cbMqtt = document.getElementById('mqttCheckbox');const cbDhcp = document.getElementById('dhcpCheckbox');const cbEth = document.getElementById('ethCbx');cbMqtt.onclick = () => { cbxAcn(cbMqtt, cbDhcp, cbEth);};cbDhcp.onclick = () => { cbxAcn(cbMqtt, cbDhcp, cbEth);};cbEth.onclick = () => { cbxAcn(cbMqtt, cbDhcp, cbEth);};cbxAcn(cbMqtt, cbDhcp);sleep(200).then(() => { poll();});</script></body></html>)=====";

const char setLdrPage[] PROGMEM = R"=====(<!doctypehtml><title>LUCIFERIN Web Interface</title><meta charset=utf-8><meta content="width=device-width,initial-scale=1"name=viewport><link href=https://sblantipodi.github.io/glow_worm_luciferin/static/logos/luciferin_logo.png rel=icon type=image/png><script src=https://sblantipodi.github.io/glow_worm_luciferin/third_party_scripts/jquery-3.6.0.slim.min.js crossorigin=anonymous integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI="></script><link href=https://sblantipodi.github.io/glow_worm_luciferin/third_party_scripts/bootstrap.min.css rel=stylesheet><script src=https://sblantipodi.github.io/glow_worm_luciferin/third_party_scripts/bootstrap.bundle.min.js></script><script src=https://sblantipodi.github.io/glow_worm_luciferin/third_party_scripts/iro5_2_2.js></script><link href=https://sblantipodi.github.io/glow_worm_luciferin/fa6/css/all.css rel=stylesheet><link href=https://sblantipodi.github.io/glow_worm_luciferin/webInterface_1.1.4.slim.min.css rel=stylesheet><div class="text-center bg-primary container-fluid p-2 sticky-top text-white"><h1>LUCIFERIN</h1><p id=subtitle></div><div class=container></div><script src=https://sblantipodi.github.io/glow_worm_luciferin/webInterfaceLdr_1.4.1.slim.min.js></script><footer class=ldrfoot><div class=text-center><small><span id=ldrgrp><i class="fa-solid fa-sun"></i><span id=ldr>_</span></span><br></small></div></footer>)=====";

#endif //GLOW_WORM_LUCIFERIN_WEBSETTINGS_H
