<html>
<head>
    <meta charset="utf-8"/>
    <title>Luciferin</title>
    <meta name="description" content="Bias Lighting and Ambient Light firmware, designed for Firefly Luciferin"/>
    <meta name="viewport" content="width=device-width"/>
    <link rel="icon" type="image/png"
          href="https://sblantipodi.github.io/glow_worm_luciferin/static/logos/luciferin_logo.png">

    <meta property="og:title" content="Luciferin"/>
    <meta property="og:site_name" content="Luciferin"/>
    <meta property="og:url" content="https://sblantipodi.github.io/glow_worm_luciferin/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:description"
          content="Easily allow users to install Luciferin firmware for their ESP-devices on the web."/>
    <meta property="og:image"
          content="https://sblantipodi.github.io/glow_worm_luciferin/static/logos/luciferin_logo.png"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:title" content="Luciferin"/>
    <meta name="twitter:description"
          content="Easily allow users to flash Luciferin firmware for their ESP-devices on the web."/>
    <meta name="twitter:image"
          content="https://sblantipodi.github.io/glow_worm_luciferin/static/logos/luciferin_logo.png"/>
    <script module>
        // https://unpkg.com/esp-web-tools@9.4.2/dist/web/install-button.js?module
        // https://unpkg.com/tasmota-esp-web-tools@8.1.2/dist/web/install-button.js?module
        // https://unpkg.com/tasmota-esp-web-tools/dist/web/install-button.js?module
        import(
            "https://unpkg.com/esp-web-tools@10.0.1/dist/web/install-button.js?module"
            );
        window.addEventListener("load", function (event) {
            try {
                const button = document.querySelector("esp-web-install-button");
                button.overrides = {
                    checkSameFirmware(manifest, improvInfo) {
                        const manifestFirmware = manifest.name.toLowerCase();
                        const deviceFirmware = improvInfo.firmware.toLowerCase();
                        return (manifestFirmware.includes("glow worm") && deviceFirmware.includes("firm"));
                    }
                };
            } catch (e) {
                console.log(e);
            }
        }, {once: true});
    </script>
    <style>
        body {
            font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI",
            Roboto, Ubuntu, sans-serif;
            padding: 0;
            margin: 0;
            line-height: 1.4;
            background-color: #f8f8f8;
            color: #212529;
        }

        @media (prefers-color-scheme: dark) {
            body {
                background-color: #2f333a;
                color: #d1d8e4;
            }
        }

        .content {
            max-width: 600px;
            margin: 0 auto;
            padding: 12px;
        }

        body {
            animation: content 1.5s;
        }

        @keyframes content {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .content {
            animation: fi 1.5s .7s both;
        }

        .logo {
            float: right;
            margin: 0px 0px 15px 15px;
        }

        .project .logo img {
            max-height: 50px;
        }

        a {
            color: orange;
        }

        .content pre {
            max-width: 100%;
            overflow-y: scroll;
        }

        .footer {
            margin-top: 24px;
            border-top: 1px solid #ccc;
            padding-top: 24px;
            text-align: center;
        }

        .footer .initiative {
            font-style: italic;
            margin-top: 16px;
        }

        table {
            border-spacing: 0;
        }

        td {
            padding: 8px;
            border-bottom: 1px solid #ccc;
        }

        button {
            position: relative;
            cursor: pointer;
            font-size: 24px;
            padding: 8px 58px;
            color: var(--esp-tools-button-text-color, #fff);
            background-color: var(--esp-tools-button-color, orange);
            border: none;
            border-radius: 4px;
            box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14), 0 3px 1px -2px rgba(0, 0, 0, .12), 0 1px 5px 0 rgba(0, 0, 0, .2);
            width: 290px;
        }

        button::before {
            content: " ";
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            opacity: 0.2;
            border-radius: 4px;
        }

        button:hover {
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, .14), 0 1px 7px 0 rgba(0, 0, 0, .12), 0 3px 1px -1px rgba(0, 0, 0, .2);
        }

        button:hover::before {
            background-color: rgba(255, 255, 255, .8);
        }

        button:focus {
            outline: none;
        }

        button:focus::before {
            background-color: white;
        }

        button:active::before {
            background-color: grey;
        }

        :host([active]) button {
            color: rgba(0, 0, 0, 0.38);
            background-color: rgba(0, 0, 0, 0.12);
            box-shadow: none;
            cursor: unset;
            pointer-events: none;
        }

        improv-wifi-launch-button {
            display: block;
            margin-top: 16px;
        }

        input[type="checkbox"] {
            height: 10px;
            width: 10px;
            position: relative;
            -webkit-appearance: none;
            cursor: pointer;
            margin-right: 10px;
        }

        input[type="checkbox"]:before {
            content: "";
            display: inline-block;
            position: absolute;
            box-sizing: border-box;
            height: 14px;
            width: 14px;
            border-radius: 1px;
            border: 2px solid orange;
            background-color: #ffdca7;
        }

        input[type="checkbox"]:hover::before {
            border: 1px solid #4f4f4f;
        }

        input[type="checkbox"]:checked:hover::before {
            filter: brightness(90%);
        }

        input[type="checkbox"]:checked:disabled:hover::before {
            filter: none;
        }

        input[type="checkbox"]:checked:before {
            content: "";
            display: inline-block;
            position: absolute;
            box-sizing: border-box;
            height: 14px;
            width: 14px;
            border-radius: 2px;
            border: 1px solid #ffdca7;
            background-color: #ffdca7;
        }

        input[type="checkbox"]:checked:after {
            content: "";
            display: inline-block;
            position: absolute;
            top: 5px;
            left: 2px;
            box-sizing: border-box;
            height: 5px;
            width: 10px;
            border-left: 2px solid orange;
            border-bottom: 2px solid orange;
            -webkit-transform: translateY(-1.5px) rotate(-45deg);
            transform: translateY(-1.5px) rotate(-45deg);
        }

        input[type="checkbox"]:disabled::before {
            border: 2px solid orange;
            border-radius: 2px;
            background-color: orange;
        }

        input[type="checkbox"]:checked:disabled::before {
            border: 3px solid orange;
            border-radius: 2px;
            background-color: orange;
        }

        .action_btn {
            display: inline-block;
            width: calc(50% - 4px);
            margin: 0 auto;
        }

        :root {
            --mdc-theme-primary: #795548;
        }

        ewt-install-dialog, ewt-no-port-picked-dialog {
            --mdc-theme-primary: orange;
            --esp-tools-button-color: orange;
            --esp-tools-button-text-color: orange;
            --mdc-text-field-fill-color: #f8f8f8;
        }

        .dropdown-container {
            width: 290px;
            position: relative;
        }

        select {
            width: 290px;
            height: 30px;
            font-size: 100%;
            font-weight: bold;
            cursor: pointer;
            border-radius: 0;
            background-color: #ffb73d;
            border: none;
            border-bottom: 2px solid #ffb73d;
            color: white;
            appearance: none;
            text-align: center;
            -webkit-appearance: none;
            -moz-appearance: none;
            transition: color 0.3s ease, background-color 0.3s ease, border-bottom-color 0.3s ease;
            border: none;
            border-radius: 12px;
            box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14), 0 3px 1px -2px rgba(0, 0, 0, .12), 0 1px 5px 0 rgba(0, 0, 0, .2);
        }

        /* For IE <= 11 */
        select::-ms-expand {
            display: none;
        }

        .select-icon {
            position: absolute;
            top: 0px;
            right: 190px;
            width: 0px;
            pointer-events: none;
            padding-left: 5px;
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .select-icon svg.icon {
            transition: fill 0.3s ease;
            fill: white;
        }

        select:hover,
        select:focus {
            color: orange;
            background-color: white;
            border-bottom-color: #DCDCDC;
        }

        select:hover ~ .select-icon,
        select:focus ~ .select-icon {
            background-color: white;
            border-color: #DCDCDC;
        }

        select:hover ~ .select-icon svg.icon,
        select:focus ~ .select-icon svg.icon {
            fill: gray;
        }

        .container {
            text-align: center;
            width: 100%;
        }


        .dropdown-container {
            text-align: center;
            width: 100%;
        }


        a {
            cursor: pointer;
            text-decoration: underline;
        }
    </style>

</head>
<body>
<div class="content">
    <h1>Glow Worm Luciferin</h1><a href="https://github.com/sblantipodi/firefly_luciferin" class="logo"><img
        src="static/logos/luciferin_logo.png" alt="Luciferin"/></a>

    <p>
        <b>Luciferin</b> is a generic term for the light-emitting compound found in organisms that generate
        bioluminescence
        like Fireflies and Glow Worms. <br/>
        <a href="https://github.com/sblantipodi/glow_worm_luciferin">Glow Worm Luciferin</a> is a firmware for
        ESP8266/ESP32 boards designed for the
        <a href="https://github.com/sblantipodi/firefly_luciferin">Firefly Luciferin</a> software, the combination of
        these software create the perfect
        Bias Lighting and Ambient Light system for PC.
    </p>

    <p><b>FULL firmware</b> version adds support for remote control, if you flash FULL version you MUST configure WiFi.
        With FULL firmware USB connection is optional.
        If you flash <b>LIGHT firmware</b> you MUST use USB cable.</p>
    <p>
        To try it out and install <b>Glow Worm Luciferin firmware</b>, connect an ESP to
        your computer and hit the button:
    </p>
    <div class="container">
        <p>
            <esp-web-install-button id="inst_full"
                                    manifest="static/firmware_build/manifest_full.json">
                <button slot="activate">INSTALL FULL</button>
                <span slot="unsupported"><b>Your browser is not supported!</b></span>
                <span slot="not-allowed">Ah snap, you are not allowed to use this on HTTP!</span>
            </esp-web-install-button>
            <br>
        </p>
        <p>
            <esp-web-install-button id="inst_light"
                                    manifest="static/firmware_build/manifest_light.json">
                <button slot="activate">INSTALL LIGHT</button>
            </esp-web-install-button>
        </p>
        <div class="demo">
            <div class="dropdown-container">
                <select id="version" class="btn" onchange="setManifest()">
                    <option data-manifest="static/firmware_build/manifest_full.json"
                    >Latest stable version
                    </option>
                    <option data-manifest="static/firmware_build_beta/manifest_full.json"
                    >Beta version
                    </option>
                    <option data-manifest="static/firmware_build_previous/manifest_full.json"
                    >Previous stable version
                    </option>
                </select>
                <div class="select-icon">
                    <svg focusable="false" viewBox="0 0 104 128" width="25" height="30" class="icon">
                        <path d="m2e1 95a9 9 0 0 1 -9 9 9 9 0 0 1 -9 -9 9 9 0 0 1 9 -9 9 9 0 0 1 9 9zm0-3e1a9 9 0 0 1 -9 9 9 9 0 0 1 -9 -9 9 9 0 0 1 9 -9 9 9 0 0 1 9 9zm0-3e1a9 9 0 0 1 -9 9 9 9 0 0 1 -9 -9 9 9 0 0 1 9 -9 9 9 0 0 1 9 9zm14 55h68v1e1h-68zm0-3e1h68v1e1h-68zm0-3e1h68v1e1h-68z"></path>
                    </svg>
                </div>
            </div>
        </div>
        <p>
        <div id="firefly-download"><b>Firefly Luciferin <u>latest version</u> can be downloaded <a
                href="https://github.com/sblantipodi/firefly_luciferin/releases">here</a></b></div>
        </p>
    </div>

    <p>
        <i>
            This only works in desktop Chrome and Edge. If you don't see
            your ESP device, please check your ad blocker and your drivers.
        </i>
    </p>
    <p>
        <b>If you are flashing an ESP32-C3, ESP32-S2 or ESP32-S3 <span id="esp-family"><a onClick="showHelp()">please read here.</a></span></b>
        <br>
    </p>
    <div class="footer">
        <div>
            <a href="https://github.com/sblantipodi/firefly_luciferin"><img
                    src="https://img.shields.io/github/v/release/sblantipodi/firefly_luciferin.svg?label=Firefly%20Luciferin&down_color=red&down_message=offline&up_color=4bc51d&up_message=online&logo=data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAAD1BMVEUAAAD%2F%2F%2F%2F%2F%2F%2F%2F%2FVyL%2F%2F%2F8bK2t7AAAAA3RSTlMAARYXuUDOAAAAhklEQVR42u3WyQ2AMAwEQAz9lxxCCRCuONHse2XPy3JsS98EAAAAAAAAQDpAfLywAgAADAuoJ716dw4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAwgLcCAACQH%2FB3AAAAAAAAAPoDWovrxYdjBwAAmA7QerAKAADANICnD0sBAADIDjgAPijZuQgZskEAAAAASUVORK5CYII%3D"></a>
            <a href="https://github.com/sblantipodi/glow_worm_luciferin"><img
                    src="https://img.shields.io/github/v/release/sblantipodi/glow_worm_luciferin.svg?label=Glow%20Worm%20Luciferin&down_color=red&down_message=offline&up_color=4bc51d&up_message=online&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAABBVBMVEUAAAD/////////VyL/WSf/Wiv/XTL/XjX/YTr/ZUL/Z0T/aEf/aUn/bU//clj/dFn/d17/eWH/emP/e2T/fGb/fmj/gm7/g2//iHb/inn/i3r/jHv/j3//lIT/lIX/l4j/mIn/m43/nI//npH/npL/pZr/ppr/qp//tKv/taz/tq7/t67/t6//wbr/wbv/wrv/w73/xL3/xb7/xb//x8L/ycP/ysT/ysX/zsn/z8r/1tL/19P/3Nj/3Nn/3dn/4d7/4+D/5eP/5+X/7Or/7ev/7uz/7u3/7+7/8O7/8O//8vH/8/L/9vX/9vb/9/b/+fj/+fn/+/r/+/v//Pz//f3//v7///9aJEoJAAAAA3RSTlMAARYXuUDOAAACr0lEQVR42u2aaVvaQBSFaUuQ2kbKomyiLUpdW0VtJaZVIVWQLZoY/v9PKZZksk1iEhJi2zOfmMyB8z6ZmTv3zkPiTcwtAQAAAAAAAAAAAF4cwCTiBgAAAAAAAAAAAP5agMG0efVw1QYAeGwfr5eehsq1Zuc5806zVn7SltaP24+hAIxPs8bhwrno7C6eF4za7Ol4bgCFZ62ClbMHuv3D2YpVy35X5gMYbSQpeWT9luZ/W6dIkxvCPAAdlp7JZgS7v5Cha9lOcAAn/ylB2+rfzjhpLQQ+AO5M/qs5Y49pmf1bjHE0t2oiuAsGcF8jE1k9uRFlSRSOSmRJMJxxqXLEP1k6EkRJFm9OqkRbuw8E0CLLnlMom4LZlbWncoN4sbyu/Uk2xZcgAP1ljd+08YcVomzImj95VBmawoL2Dt/2AwDsUf2nBB91gj92vS3yYGdoCUwawZ5/AEldc2u2wKccEm2+N/XPk+6hLeqM1BnLSb4BrtUub9/xygFZcvmu7s8cKHYtrw5e+wbYV1+ARAt6l2lNvfRB+5S+pCmltdnovm+A7Vnvgh72dQJ3/8nkYjZc9g0w66S6DufeVdH8reIvB2E3Zdnd/gAKzkmHiaDonIAUIgKYDDb172y6JEv/LMCCpsD7IrwKexHGvg09BqJUKqpA5BaKv6b1UNyNKhRrhxE7CuMwykohHsc7RLrV83ocN2NOSJb7EaRkyYaeku0ytJTsB0nJuEiSUuOEuyelnxaRlr8LPy33V5gIERQm8Zdm/opTsU7Tfh4trjxXOHt5zsd6QVH9Nv8FRZArmsr7aS1UCe2KJsAl1XgwGOKeEAAAAAAAAAAAAAAgOAD+SQUAAAAAAAAAwP8H4LW9UttzP/habYmwGwAAAIDYASILMAAAAABePMDCEg4AAAAAcQH8BmpkuUqa4Ih2AAAAAElFTkSuQmCC"></a>
            <a href="https://github.com/sblantipodi/firefly_luciferin/wiki"><img
                    src="https://img.shields.io/website/https/sblantipodi.github.io/glow_worm_luciferin.svg?label=Wiki&down_color=red&down_message=offline&up_color=4bc51d&up_message=online&logo=read-the-docs"></a>
            </div>
        <div>
            <a href="https://www.paypal.com/donate?hosted_button_id=ZEJM8ZLQW5E4A"><img
                    src="https://img.shields.io/badge/donate-PayPal-blue"></a>
            <a href="https://www.paypal.com/donate?hosted_button_id=ZEJM8ZLQW5E4A"><img
                    src="https://img.shields.io/static/v1?label=DP&message=Software&color=orange"></a>
            <a href="https://discord.gg/aXf9jeN"><img
                    src="https://img.shields.io/discord/747247942074892328.svg?label=&logo=discord&logoColor=ffffff&color=7389D8&labelColor=6A7EC2"></a>
        </div>
    </div>
</div>
<script>
    function setManifest() {
        var sel = document.getElementById('version');
        var opt = sel.options[sel.selectedIndex];
        var full_manifest = opt.dataset.manifest;
        console.log(full_manifest);
        var light_manifest = full_manifest;
        light_manifest = light_manifest.replace("manifest_full.json", "manifest_light.json");
        if (full_manifest.includes("beta")) {
            document.getElementById("firefly-download").innerHTML = "<b>Firefly Luciferin <u>beta version</u> can be downloaded <a href=\"https://github.com/sblantipodi/firefly_luciferin/actions\">here</a><br>NOTE: Using Glow Worm Luciferin beta version requires the latest Firefly Luciferin beta version. Please prefer the latest stable version unless you know exactly what you are doing.</b>";
        } else if (full_manifest.includes("prev")) {
            document.getElementById("firefly-download").innerHTML = "<b>Firefly Luciferin <u>previous stable version</u> can be downloaded <a href=\"https://github.com/sblantipodi/firefly_luciferin/releases\">here</a></b>";
        } else {
            document.getElementById("firefly-download").innerHTML = "<b>Firefly Luciferin <u>latest stable version</u> can be downloaded <a href=\"https://github.com/sblantipodi/firefly_luciferin/releases\">here</a></b>";
        }
        document.getElementById('inst_full').setAttribute('manifest', full_manifest);
        document.getElementById('inst_light').setAttribute('manifest', light_manifest);
    }

    function showHelp() {
        document.getElementById('esp-family').innerHTML = `</br></br>
            Web Installer for ESP32-C3, ESP32-S3, ESP32-S3 is a work in progress.</br>
            If you are installing the firmware for the first time, please do the following.
            <ul>
                <li>Put your boards into Device Firmware Upgrade (DFU) mode.</li>
                <li>Hold on Button Boot</li>
                <li>Press Button Reset</li>
                <li>Release Button Boot when you hear the prompt tone on usb reconnection</li>
                <li>The device is now into DFU mode, you can now click the install button.</li>
            </ul>
            NOTE: If you are installing the FULL firmware and you don't see the option to configure WiFi after installation is complete,
            hit the reset button and try again by clicking the install button, you should now see the option to set up WiFi.
        `;
    }
</script>
</body>
</html>
